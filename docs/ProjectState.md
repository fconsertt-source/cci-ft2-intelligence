# حالة المشروع الحالية (Project State)

تاريخ المسح: 2026-01-31

الهدف: وثيقة مرجعية توضح الهيكل الحالي للمشروع، مطابقته لنموذج الطبقات في ميثاق الهندسة، وتحديد الانحرافات والمجلدات المتحركة/القديمة.

## ملخص نموذج الطبقات (بناءً على الميثاق)

نموذج الطبقات المتبع: Domain (جوهر العمل) ← Application (حالات الاستخدام) ← Infrastructure (التقنية) ← Interfaces (واجهات)

## مطابقة المجلدات الحالية إلى الطبقات

- **Domain**:
  - `src/core/` — كيانات المجال، القواعد العلمية، النماذج الأساسية (calculators, entities, value_objects)

- **Application**:
  - `src/api/application/` — حالات الاستخدام (`use_cases`), DTOs (`dtos`)

- **Infrastructure**:
  - `src/*` (submodules) — موصلات التقارير، محركات التوليد، الخدمات المساعدة
  - `ft2_reader/` — قارئ FT2 (Parsing/IO)
  - `ingestion/` — أنابيب استيعاب ومعالجة البيانات
  - `ingestion/reporting/` — مخرجات CSV و PDF

- **Interfaces**:
  - `src/api/` — نقاط الدخول (API)
  - `scripts/` — أدوات مساعدة وواجهات سطر أوامر
  - `visualization/` — مكونات العرض

## مجلدات بنية المشروع الأخرى

- `data/` — عينات، إدخالات ونتائج معالجة (أصول بيانات، ليست كود)
- `assets/` — موارد ثابتة (خطوط...)، تستخدم من قبل واجهات
- `config/` — إعدادات YAML ومكتبات التكوين
- `tests/` — اختبارات الوحدة والتكامل
- `docs/` — توثيق هندسي وعلمي

## ملاحظات على الانحرافات عن الميثاق

1. توجد وحدات وظيفية خارج `src/` مثل `ft2_reader/` و `ingestion/`. وفق الميثاق يجب أن تتبع طبقات واضحة؛ حالياً هذه المجلدات تؤدي دور Infrastructure لكنها تقع خارج الهيكل الموحد `src/`.
2. `scripts/` يحتوي على أدوات تنفيذية مساعدة؛ من الأفضل تصنيفها صراحة كـ Interfaces/Tools أو نقله إلى `tools/` مستقبلًا.
3. بيئات افتراضية (مثل `.venv/` و `venv/`) موجودة محليًا — يجب استبعادها من المستودع.

## مجلدات/عناصر مرشحة كـ "عائمة/قديمة"

- `scripts/` — أدوات قديمة أو ذاكرة من مراحل سابقة؛ تحتاج مراجعة ترحيل/إلغاء.
- أي ملف سجل كبير مثل `pipeline.log` — لا يجب تعقبه داخل المستودع.
- أي مجلد بيئة افتراضية `.venv/`, `venv/` — يجب إضافتها إلى `.gitignore` وعدم نسخها.

## توصيات سريعة قبل أي Refactor

1. إجراء نسخة احتياطية كاملة للمشروع (تمت: `backup/`).
2. توثيق جميع القرارات في ADRs داخل `docs/adr/` (تم إضافة ADR ابتدائي).
3. وضع خطة لنقل أو توحيد `ft2_reader/` و `ingestion/` داخل بنية `src/` تحت طبقة Infrastructure إن أمكن.
4. تنظيف المجلدات العائمة بعد الموافقة عبر ADR.

## مراجع

- ميثاق الهندسة: `docs/architecture/ENGINEERING_CHARTER.md`
- ADRs: `docs/adr/`
